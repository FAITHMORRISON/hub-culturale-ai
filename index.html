<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mio Hub Culturale</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg: #f0f2f5; --card: #ffffff; --text: #2d3436;
            --primary: #6c5ce7; --secondary: #a29bfe;
        }
        .dark-mode {
            --bg: #1a1a1a; --card: #2d2d2d; --text: #f5f6fa;
            --primary: #a29bfe;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); transition: 0.3s; margin: 0; padding: 15px; }
        .container { max-width: 600px; margin: auto; }

        /* Header e Controlli */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .dark-toggle { cursor: pointer; font-size: 20px; color: var(--primary); }

        /* Input Area */
        .input-card { background: var(--card); padding: 15px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); margin-bottom: 20px; }
        textarea { width: 100%; height: 100px; background: transparent; color: var(--text); border: 1px solid #ddd; border-radius: 10px; padding: 12px; box-sizing: border-box; resize: none; font-size: 16px; }
        .input-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; }
        #charCount { font-size: 12px; color: #636e72; }

        button#btnSalva { 
            padding: 10px 20px; background: var(--primary); color: white; border: none; 
            border-radius: 8px; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 8px;
        }

        /* Spinner Animazione */
        .spinner { display: none; width: 18px; height: 18px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Accordion */
        .acc-item { background: var(--card); margin-bottom: 10px; border-radius: 12px; overflow: hidden; border-left: 6px solid var(--c); box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .acc-header { width: 100%; padding: 15px; display: flex; justify-content: space-between; align-items: center; background: none; border: none; cursor: pointer; font-size: 16px; font-weight: bold; color: var(--text); }
        .acc-content { display: none; padding: 10px 15px; background: rgba(0,0,0,0.02); }
        .acc-content.active { display: block; }

        /* Note e Bottoni */
        .item-nota { background: var(--bg); padding: 12px; border-radius: 10px; margin-bottom: 10px; position: relative; border: 1px solid rgba(0,0,0,0.05); }
        .item-actions { display: flex; gap: 10px; margin-top: 8px; justify-content: flex-end; }
        .action-btn { background: none; border: none; cursor: pointer; font-size: 14px; color: #636e72; transition: 0.2s; }
        .action-btn:hover { color: var(--primary); }
        .item-date { font-size: 10px; opacity: 0.6; }

        /* Toast Message */
        #toast { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #2d3436; color: white; padding: 10px 20px; border-radius: 20px; display: none; font-size: 14px; z-index: 1000; }
    </style>
</head>
<body>

    <div id="toast">Copiato!</div>

    <div class="container">
        <header>
            <h1>ðŸ§  Second Brain</h1>
            <div class="dark-toggle" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></div>
        </header>

        <div class="input-card">
            <textarea id="userInput" oninput="updateCharCount()" placeholder="Incolla qui... (es. 'tutorial ricetta dolce')"></textarea>
            <div class="input-footer">
                <span id="charCount">Caratteri: 0</span>
                <button id="btnSalva" onclick="gestisciInvio()">
                    <div class="spinner" id="spinner"></div>
                    <span id="btnText"><i class="fas fa-magic"></i> Organizza</span>
                </button>
            </div>
        </div>

        <div id="status" style="text-align: center; font-size: 12px; margin-bottom: 10px;"></div>

        <div class="accordion-container">
            <div class="acc-item" style="--c: #3498db;">
                <button class="acc-header" onclick="toggleAcc('list-musica')"><span><i class="fas fa-music"></i> Musica</span><i class="fas fa-chevron-down"></i></button>
                <div class="acc-content" id="list-musica"></div>
            </div>
            <div class="acc-item" style="--c: #e67e22;">
                <button class="acc-header" onclick="toggleAcc('list-libri')"><span><i class="fas fa-book"></i> Libri</span><i class="fas fa-chevron-down"></i></button>
                <div class="acc-content" id="list-libri"></div>
            </div>
            <div class="acc-item" style="--c: #9b59b6;">
                <button class="acc-header" onclick="toggleAcc('list-arte')"><span><i class="fas fa-palette"></i> Arte & Ref</span><i class="fas fa-chevron-down"></i></button>
                <div class="acc-content" id="list-arte"></div>
            </div>
            <div class="acc-item" style="--c: #2ecc71;">
                <button class="acc-header" onclick="toggleAcc('list-tutorial')"><span><i class="fas fa-lightbulb"></i> Tutorial</span><i class="fas fa-chevron-down"></i></button>
                <div class="acc-content" id="list-tutorial"></div>
            </div>
            <div class="acc-item" style="--c: #95a5a6;">
                <button class="acc-header" onclick="toggleAcc('list-extra')"><span><i class="fas fa-folder"></i> Altro</span><i class="fas fa-chevron-down"></i></button>
                <div class="acc-content" id="list-extra"></div>
            </div>
        </div>
    </div>

    <script>
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const icon = document.querySelector('.dark-toggle i');
            icon.classList.toggle('fa-moon');
            icon.classList.toggle('fa-sun');
        }

        function updateCharCount() {
            const len = document.getElementById('userInput').value.length;
            document.getElementById('charCount').textContent = `Caratteri: ${len}`;
        }

        function toggleAcc(id) {
            document.getElementById(id).classList.toggle('active');
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 2000);
        }

        function copyText(btn, text) {
            navigator.clipboard.writeText(text);
            showToast("Copiato in appunti!");
        }

        function deleteNote(btn) {
            if(confirm("Vuoi eliminare questa nota locale?")) {
                btn.closest('.item-nota').remove();
            }
        }

        function gestisciInvio() {
            const area = document.getElementById('userInput');
            const testo = area.value.trim();
            if(!testo) return;

            // Mostra animazione caricamento
            document.getElementById('spinner').style.display = 'block';
            document.getElementById('btnText').style.display = 'none';

            let cat = "extra";
            const t = testo.toLowerCase();
            if(t.includes("tutorial") || t.includes("come")) cat = "tutorial";
            else if(t.includes("musica") || t.includes("canzone") || t.includes("band")) cat = "musica";
            else if(t.includes("libro") || t.includes("autore")) cat = "libri";
            else if(t.includes("arte") || t.includes("mostra") || t.includes("museo")) cat = "arte";

            setTimeout(() => {
                const lista = document.getElementById('list-' + cat);
                const data = new Date().toLocaleString('it-IT', {day:'2-digit', month:'2-digit', hour:'2-digit', minute:'2-digit'});
                
                const div = document.createElement('div');
                div.className = 'item-nota';
                div.innerHTML = `
                    <div>${testo}</div>
                    <div class="item-actions">
                        <span class="item-date">${data}</span>
                        <button class="action-btn" onclick="copyText(this, '${testo.replace(/'/g, "\\'")}')"><i class="fas fa-copy"></i></button>
                        <button class="action-btn" onclick="deleteNote(this)"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                
                lista.prepend(div);
                lista.classList.add('active');
                
                // Reset interfaccia
                area.value = "";
                updateCharCount();
                document.getElementById('spinner').style.display = 'none';
                document.getElementById('btnText').style.display = 'block';
                showToast("Nota organizzata!");
            }, 1000);
        }
    </script>
</body>
</html>
